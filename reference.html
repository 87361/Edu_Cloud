<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学生课程仪表盘</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* 自定义滚动条样式 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* 简单的卡片悬浮效果 */
        .course-card { transition: all 0.3s ease; }
        .course-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body class="bg-gray-50 h-screen overflow-hidden text-gray-800">

<div id="app" class="flex h-full">

    <aside class="w-72 bg-white border-r border-gray-200 flex flex-col shadow-sm z-10">
        <div class="p-6 border-b border-gray-100 flex items-center space-x-3">
            <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold">S</div>
            <div>
                <h2 class="font-bold text-lg">同学你好</h2>
                <p class="text-xs text-gray-500">学号: 2024001</p>
            </div>
        </div>

        <div class="p-4 flex-1 overflow-y-auto">
            <div @click="goHome" class="flex items-center space-x-3 p-3 rounded-lg cursor-pointer hover:bg-blue-50 mb-6 transition-colors" :class="{'bg-blue-50 text-blue-600': currentView === 'dashboard'}">
                <i class="fa-solid fa-house"></i>
                <span class="font-medium">课程大厅</span>
            </div>

            <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3 px-3">待办作业 ({{ todos.length }})</h3>
            <div class="space-y-2">
                <div 
                    v-for="todo in todos" 
                    :key="todo.id"
                    @click="handleTodoClick(todo)"
                    class="group p-3 rounded-lg border border-transparent hover:border-blue-100 hover:bg-blue-50 cursor-pointer transition-all relative overflow-hidden"
                >
                    <div class="absolute left-0 top-0 bottom-0 w-1" :class="getUrgencyColor(todo.deadline)"></div>
                    
                    <div class="pl-2">
                        <div class="flex justify-between items-start mb-1">
                            <span class="text-sm font-medium line-clamp-1 group-hover:text-blue-700">{{ todo.title }}</span>
                        </div>
                        <div class="flex justify-between items-center text-xs text-gray-500">
                            <span>{{ getCourseName(todo.courseId) }}</span>
                            <span :class="getUrgencyTextColor(todo.deadline)">{{ formatDate(todo.deadline) }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </aside>

    <main class="flex-1 overflow-y-auto bg-gray-50 p-8 relative">
        
        <div v-if="currentView === 'dashboard'" class="max-w-7xl mx-auto">
            <header class="mb-8">
                <h1 class="text-3xl font-bold text-gray-900">我的课程</h1>
                <p class="text-gray-500 mt-2">本学期共修读 {{ courses.length }} 门课程</p>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <div 
                    v-for="course in courses" 
                    :key="course.id"
                    @click="goToCourseDetail(course)"
                    class="course-card bg-white rounded-xl border border-gray-100 overflow-hidden cursor-pointer"
                >
                    <div class="h-32 bg-gray-200 relative">
                        <img :src="course.cover" class="w-full h-full object-cover" alt="Course Cover">
                        <div class="absolute top-2 right-2 bg-white/90 backdrop-blur px-2 py-1 rounded text-xs font-bold text-gray-700">
                            {{ course.progress }}%
                        </div>
                    </div>
                    <div class="p-5">
                        <div class="text-xs font-bold text-blue-500 mb-2">{{ course.category }}</div>
                        <h3 class="font-bold text-lg mb-2 text-gray-800">{{ course.title }}</h3>
                        <p class="text-sm text-gray-500 line-clamp-2 mb-4">{{ course.desc }}</p>
                        <div class="flex items-center text-xs text-gray-400">
                            <i class="fa-regular fa-user mr-1"></i> {{ course.teacher }}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div v-else-if="currentView === 'course-detail'" class="max-w-5xl mx-auto animate-fade-in">
            <nav class="flex items-center text-sm text-gray-500 mb-6">
                <span @click="goHome" class="hover:text-blue-600 cursor-pointer">课程大厅</span>
                <i class="fa-solid fa-chevron-right text-xs mx-2"></i>
                <span class="font-bold text-gray-900">{{ currentCourse.title }}</span>
            </nav>

            <div class="bg-white rounded-2xl p-8 shadow-sm mb-8 flex items-start gap-6">
                <img :src="currentCourse.cover" class="w-24 h-24 rounded-lg object-cover shadow-md">
                <div class="flex-1">
                    <h1 class="text-3xl font-bold mb-2">{{ currentCourse.title }}</h1>
                    <p class="text-gray-600 mb-4">{{ currentCourse.desc }}</p>
                    <div class="flex gap-4">
                        <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">继续学习</button>
                        <button class="bg-white border border-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-50">课程资料</button>
                    </div>
                </div>
            </div>

            <h2 class="text-xl font-bold mb-4">课程作业</h2>
            <div class="space-y-4">
                <div 
                    v-for="assign in getCourseAssignments(currentCourse.id)" 
                    :key="assign.id"
                    @click="goToAssignmentDetail(assign)"
                    class="bg-white p-5 rounded-xl border border-gray-100 hover:border-blue-200 cursor-pointer flex justify-between items-center transition-colors"
                >
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center" 
                             :class="assign.status === 'completed' ? 'bg-green-100 text-green-600' : 'bg-orange-100 text-orange-600'">
                             <i :class="assign.status === 'completed' ? 'fa-solid fa-check' : 'fa-solid fa-pen'"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800">{{ assign.title }}</h3>
                            <p class="text-sm text-gray-500">截止: {{ assign.deadline }}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="text-sm px-3 py-1 rounded-full" 
                              :class="assign.status === 'completed' ? 'bg-green-50 text-green-600' : 'bg-orange-50 text-orange-600'">
                            {{ assign.status === 'completed' ? '已完成' : '未完成' }}
                        </span>
                        <i class="fa-solid fa-chevron-right text-gray-300"></i>
                    </div>
                </div>
            </div>
        </div>

        <div v-else-if="currentView === 'assignment-detail'" class="max-w-4xl mx-auto">
            <nav class="flex items-center text-sm text-gray-500 mb-6">
                <span @click="goHome" class="hover:text-blue-600 cursor-pointer">课程大厅</span>
                <i class="fa-solid fa-chevron-right text-xs mx-2"></i>
                <span @click="goToCourseDetail(currentCourse)" class="hover:text-blue-600 cursor-pointer">{{ currentCourse.title }}</span>
                <i class="fa-solid fa-chevron-right text-xs mx-2"></i>
                <span class="font-bold text-gray-900">作业详情</span>
            </nav>

            <div class="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden">
                <div class="p-8 border-b border-gray-100">
                    <div class="flex justify-between items-start mb-4">
                        <h1 class="text-2xl font-bold text-gray-900">{{ currentAssignment.title }}</h1>
                        <span class="bg-red-50 text-red-600 px-3 py-1 rounded text-sm font-medium">截止: {{ currentAssignment.deadline }}</span>
                    </div>
                    <p class="text-gray-600 leading-relaxed">
                        {{ currentAssignment.desc }}
                        <br><br>
                        请阅读附件中的PDF文档，并根据要求完成代码编写。最终提交一个 .zip 压缩包。
                    </p>
                </div>
                
                <div class="p-8 bg-gray-50">
                    <h3 class="font-bold mb-4 text-gray-700">提交作业</h3>
                    <div class="border-2 border-dashed border-gray-300 rounded-xl p-10 text-center hover:bg-white hover:border-blue-400 transition-colors cursor-pointer group">
                        <i class="fa-solid fa-cloud-arrow-up text-4xl text-gray-400 mb-3 group-hover:text-blue-500"></i>
                        <p class="text-gray-500 group-hover:text-gray-700">点击上传文件 或 拖拽文件到此处</p>
                    </div>
                    <div class="mt-6 flex justify-end">
                        <button class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 shadow-md transition transform active:scale-95">
                            确认提交
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </main>
</div>

<script>
    const { createApp, ref, computed } = Vue;

    createApp({
        setup() {
            // ---------------- 数据模拟 ----------------
            const courses = ref([
                { id: 1, title: '高级交互设计', category: '设计', teacher: '王教授', progress: 85, cover: 'https://placehold.co/600x400/3b82f6/ffffff?text=Interaction', desc: '学习如何构建以用户为中心的数字产品体验。' },
                { id: 2, title: 'Vue.js 前端开发', category: '编程', teacher: '张讲师', progress: 40, cover: 'https://placehold.co/600x400/42b883/ffffff?text=Vue.js', desc: '深入理解 Vue 3 组合式 API 与生态系统。' },
                { id: 3, title: '数据结构与算法', category: '计算机', teacher: '李教授', progress: 10, cover: 'https://placehold.co/600x400/6366f1/ffffff?text=Algorithms', desc: '掌握核心算法逻辑与数据存储结构。' },
                { id: 4, title: '数字媒体艺术', category: '艺术', teacher: '赵老师', progress: 60, cover: 'https://placehold.co/600x400/ec4899/ffffff?text=Media+Art', desc: '探索技术与艺术的边界，创造沉浸式体验。' },
            ]);

            // 所有作业库 (status: pending, completed)
            const allAssignments = ref([
                { id: 101, courseId: 1, title: '期中原型设计', deadline: '2023-10-25', status: 'pending', desc: '使用Figma完成一款App的高保真原型设计。' },
                { id: 102, courseId: 1, title: '用户调研报告', deadline: '2023-11-01', status: 'pending', desc: '撰写不少于2000字的用户画像分析报告。' },
                { id: 201, courseId: 2, title: 'Todo List 开发', deadline: '2023-10-24', status: 'pending', desc: '使用 Vue 3 完成一个带有增删改查功能的待办清单。' },
                { id: 202, courseId: 2, title: '组件库封装', deadline: '2023-12-10', status: 'completed', desc: '封装一个通用的 Button 组件。' },
                { id: 301, courseId: 3, title: '二叉树遍历', deadline: '2023-10-28', status: 'pending', desc: '实现二叉树的前序、中序、后序遍历算法。' },
            ]);

            // ---------------- 状态管理 ----------------
            const currentView = ref('dashboard'); // dashboard, course-detail, assignment-detail
            const currentCourse = ref(null);
            const currentAssignment = ref(null);

            // ---------------- 计算属性 ----------------
            // 左侧导航只显示 pending 状态的作业
            const todos = computed(() => {
                return allAssignments.value
                    .filter(a => a.status === 'pending')
                    .sort((a, b) => new Date(a.deadline) - new Date(b.deadline));
            });

            // ---------------- 方法逻辑 ----------------
            
            // 1. 获取课程名称 (用于 Sidebar 显示)
            const getCourseName = (id) => {
                const c = courses.value.find(c => c.id === id);
                return c ? c.title : '未知课程';
            };

            // 2. 获取某门课的所有作业
            const getCourseAssignments = (courseId) => {
                return allAssignments.value.filter(a => a.courseId === courseId);
            };

            // 3. 导航逻辑
            const goHome = () => {
                currentView.value = 'dashboard';
                currentCourse.value = null;
                currentAssignment.value = null;
            };

            const goToCourseDetail = (course) => {
                currentCourse.value = course;
                currentView.value = 'course-detail';
            };

            const goToAssignmentDetail = (assignment) => {
                // 确保我们也设置了 currentCourse，这样面包屑导航才能工作
                if (!currentCourse.value || currentCourse.value.id !== assignment.courseId) {
                    currentCourse.value = courses.value.find(c => c.id === assignment.courseId);
                }
                currentAssignment.value = assignment;
                currentView.value = 'assignment-detail';
            };

            // 4. 核心：点击左侧代办事项的联动逻辑
            const handleTodoClick = (todo) => {
                // 1. 找到对应的课程
                const relatedCourse = courses.value.find(c => c.id === todo.courseId);
                if (relatedCourse) {
                    currentCourse.value = relatedCourse;
                    // 2. 设置当前作业
                    currentAssignment.value = todo;
                    // 3. 跳转视图
                    currentView.value = 'assignment-detail';
                }
            };

            // 辅助函数：日期格式化
            const formatDate = (dateStr) => {
                const date = new Date(dateStr);
                return `${date.getMonth() + 1}月${date.getDate()}日`;
            };

            // 辅助函数：紧急程度颜色
            const getUrgencyColor = (dateStr) => {
                const days = (new Date(dateStr) - new Date()) / (1000 * 3600 * 24);
                if (days < 2) return 'bg-red-500';
                if (days < 5) return 'bg-orange-400';
                return 'bg-blue-400';
            };

             const getUrgencyTextColor = (dateStr) => {
                const days = (new Date(dateStr) - new Date()) / (1000 * 3600 * 24);
                if (days < 2) return 'text-red-500 font-bold';
                return 'text-gray-500';
            };

            return {
                courses,
                todos,
                currentView,
                currentCourse,
                currentAssignment,
                getCourseName,
                getCourseAssignments,
                goHome,
                goToCourseDetail,
                goToAssignmentDetail,
                handleTodoClick,
                formatDate,
                getUrgencyColor,
                getUrgencyTextColor
            };
        }
    }).mount('#app');
</script>

</body>
</html>
